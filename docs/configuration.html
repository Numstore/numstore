<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuration - Numstore Documentation</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>Numstore Configuration</h1>
        <p>System-level and variable-level configuration options</p>
    </header>

    <nav>
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="getting-started.html">Getting Started</a></li>
            <li><a href="features.html">Features</a></li>
            <li><a href="api-reference.html">API Reference</a></li>
            <li><a href="configuration.html">Configuration</a></li>
            <li><a href="examples.html">Examples</a></li>
            <li><a href="downloads.html">Downloads</a></li>
            <li><a href="about.html">About</a></li>
        </ul>
    </nav>

    <main>
        <section class="section">
            <h2>System-Level Configuration</h2>
            <p>System-level settings affect the entire Numstore instance.</p>

            <h3>Page Size</h3>
            <p>
                The page size determines the granularity of I/O operations. Larger pages can improve
                throughput for large sequential operations, while smaller pages may be better for
                random access patterns.
            </p>
            <ul>
                <li><strong>Default:</strong> 4096 bytes (4 KB)</li>
                <li><strong>Range:</strong> 512 bytes to 64 KB</li>
                <li><strong>Recommendation:</strong> Use 4 KB for general workloads, 8-16 KB for large sequential operations</li>
            </ul>
            <pre><code># Set via environment variable
export NUMSTORE_PAGE_SIZE=8192

# Or via configuration file
page_size = 8192</code></pre>

            <h3>Number of Threads</h3>
            <p>
                Controls the number of worker threads for parallel operations.
            </p>
            <ul>
                <li><strong>Default:</strong> Number of CPU cores</li>
                <li><strong>Range:</strong> 1 to 128</li>
                <li><strong>Recommendation:</strong> Use default for most workloads</li>
            </ul>
            <pre><code># Set via environment variable
export NUMSTORE_THREADS=8

# Or via configuration file
num_threads = 8</code></pre>

            <h3>Memory Limits</h3>
            <p>Configure memory usage limits for various components.</p>

            <h4>Buffer Pool Size</h4>
            <p>
                The buffer pool caches frequently accessed pages in memory.
            </p>
            <ul>
                <li><strong>Default:</strong> 256 MB</li>
                <li><strong>Range:</strong> 16 MB to system RAM</li>
                <li><strong>Recommendation:</strong> Allocate 25-50% of available RAM for data-intensive workloads</li>
            </ul>
            <pre><code># Set via environment variable
export NUMSTORE_BUFFER_POOL_SIZE=1073741824  # 1 GB

# Or via configuration file
buffer_pool_size = 1073741824</code></pre>

            <h4>WAL Buffer Size</h4>
            <p>
                Size of the write-ahead log buffer.
            </p>
            <ul>
                <li><strong>Default:</strong> 16 MB</li>
                <li><strong>Range:</strong> 1 MB to 256 MB</li>
            </ul>
            <pre><code>wal_buffer_size = 33554432  # 32 MB</code></pre>
        </section>

        <section class="section">
            <h2>Variable-Level Configuration</h2>
            <p>Some settings can be configured per-variable for fine-grained control.</p>

            <h3>Windowed Access</h3>
            <p>
                Enable windowed access mode for very large variables that don't fit in memory.
                In this mode, only a window of data is kept in memory at a time.
            </p>
            <pre><code># Create a windowed variable
create large_data struct { x f64 } --windowed --window-size=1000000

# Window size is the number of elements to keep in memory</code></pre>

            <h3>Compression</h3>
            <p>
                Enable compression for a variable to reduce disk space usage.
            </p>
            <pre><code># Create a compressed variable
create compressed_data [100] f64 --compress

# Supported compression algorithms: lz4, zstd, snappy</code></pre>
        </section>

        <section class="section">
            <h2>Configuration File</h2>
            <p>
                Create a <code>numstore.conf</code> file in your working directory or
                <code>~/.numstore/config</code> for user-wide settings.
            </p>
            <pre><code># numstore.conf example

# System settings
page_size = 8192
num_threads = 8
buffer_pool_size = 1073741824

# WAL settings
wal_buffer_size = 33554432
wal_sync_mode = full  # full, normal, or async

# Logging
log_level = info  # debug, info, warn, error
log_file = /var/log/numstore.log

# Performance tuning
cache_hit_ratio_target = 0.95
checkpoint_interval = 300  # seconds</code></pre>
        </section>

        <section class="section">
            <h2>Performance Tuning</h2>

            <h3>For High Throughput</h3>
            <ul>
                <li>Increase buffer pool size to cache more data</li>
                <li>Use larger page sizes (8-16 KB)</li>
                <li>Enable async WAL sync mode (at cost of durability)</li>
                <li>Increase number of threads for parallel workloads</li>
            </ul>

            <h3>For Low Latency</h3>
            <ul>
                <li>Use smaller page sizes (4 KB or less)</li>
                <li>Maximize buffer pool to avoid disk I/O</li>
                <li>Use full WAL sync mode for consistency</li>
                <li>Enable windowed access for large datasets</li>
            </ul>

            <h3>For Limited Memory</h3>
            <ul>
                <li>Reduce buffer pool size</li>
                <li>Enable compression on variables</li>
                <li>Use windowed access with small window sizes</li>
                <li>Reduce number of threads</li>
            </ul>
        </section>

        <section class="section">
            <h2>Monitoring</h2>
            <p>Check current configuration and performance metrics:</p>
            <pre><code># View current configuration
./nstore "show config"

# View performance metrics
./nstore "show metrics"

# Key metrics to monitor:
# - Buffer pool hit ratio (target: >90%)
# - Average operation latency
# - WAL write throughput
# - Cache eviction rate</code></pre>
        </section>
    </main>

    <footer>
        <p>Copyright 2025 Theo Lincke | Licensed under the Apache License 2.0</p>
        <p><a href="https://gitlab.com/lincketheo/numstore">GitHub Repository</a></p>
    </footer>
</body>
</html>
