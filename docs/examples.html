<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Examples - Numstore Documentation</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>Numstore Examples</h1>
        <p>Code examples and tutorials</p>
    </header>

    <nav>
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="getting-started.html">Getting Started</a></li>
            <li><a href="features.html">Features</a></li>
            <li><a href="api-reference.html">API Reference</a></li>
            <li><a href="configuration.html">Configuration</a></li>
            <li><a href="examples.html">Examples</a></li>
            <li><a href="downloads.html">Downloads</a></li>
            <li><a href="about.html">About</a></li>
        </ul>
    </nav>

    <main>
        <section class="section">
            <h2>Basic Examples</h2>

            <h3>Example 1: Basic Persistence</h3>
            <p>Create a variable, insert data, and read it back:</p>
            <pre><code># Create a simple integer array
./nstore "create numbers i32"

# Insert some numbers (binary data)
echo -e "\\x01\\x00\\x00\\x00\\x02\\x00\\x00\\x00\\x03\\x00\\x00\\x00" | \
  ./nstore "insert numbers 0"

# Read back the data
./nstore "read numbers 0:3:1" | hexdump -C

# Delete the variable
./nstore "delete numbers"</code></pre>

            <h3>Example 2: Working with Structs</h3>
            <pre><code># Create a struct for 2D points
./nstore "create points struct { x f64, y f64 }"

# Insert point data (x=1.0, y=2.0)
echo -e "\\x00\\x00\\x00\\x00\\x00\\x00\\xf0\\x3f\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x40" | \
  ./nstore "insert points 0"

# Read just the x coordinates
./nstore "read points[x] 0:1:1" | hexdump -C

# Read just the y coordinates
./nstore "read points[y] 0:1:1" | hexdump -C</code></pre>

            <h3>Example 3: Strided Access</h3>
            <pre><code># Create an array of numbers
./nstore "create data i32"

# Insert 10 numbers
cat ten_numbers.bin | ./nstore "insert data 0 10"

# Read every other number (stride=2)
./nstore "read data 0:10:2" > every_other.bin

# Read every third number (stride=3)
./nstore "read data 0:10:3" > every_third.bin</code></pre>
        </section>

        <section class="section">
            <h2>C Library Examples</h2>
            <p>The repository includes 15+ comprehensive C examples. Build and run them:</p>
            <pre><code># Build all examples
make

# Run examples
./build/debug/apps/examples/nsfslite/example1_basic_persistence
./build/debug/apps/examples/nsfslite/example2_transactions
./build/debug/apps/examples/nsfslite/example3_crash_recovery</code></pre>

            <h3>Basic C Example</h3>
            <pre><code>#include &lt;nsfslite.h&gt;
#include &lt;stdio.h&gt;

int main() {
    // Open database
    nsfs_t* db = nsfs_open("mydb", NSFS_CREATE);
    if (!db) {
        fprintf(stderr, "Failed to open database\\n");
        return 1;
    }

    // Create a variable
    if (nsfs_create(db, "data", "i32") != NSFS_OK) {
        fprintf(stderr, "Failed to create variable\\n");
        return 1;
    }

    // Insert data
    int32_t data[] = {1, 2, 3, 4, 5};
    if (nsfs_insert(db, "data", 0, data, 5) != NSFS_OK) {
        fprintf(stderr, "Failed to insert data\\n");
        return 1;
    }

    // Read data back
    int32_t result[5];
    if (nsfs_read(db, "data", 0, 5, 1, result) != NSFS_OK) {
        fprintf(stderr, "Failed to read data\\n");
        return 1;
    }

    // Print results
    for (int i = 0; i < 5; i++) {
        printf("%d ", result[i]);
    }
    printf("\\n");

    // Close database
    nsfs_close(db);
    return 0;
}</code></pre>
        </section>

        <section class="section">
            <h2>Python Examples</h2>

            <h3>Basic Python Usage</h3>
            <pre><code>import numstore
import numpy as np

# Create database
db = numstore.Database("mydb")

# Create a variable for 2D points
db.create("points", "struct { x f64, y f64 }")

# Create some points
points = np.array([(1.0, 2.0), (3.0, 4.0), (5.0, 6.0)],
                  dtype=[('x', 'f8'), ('y', 'f8')])

# Insert points
db.insert("points", 0, points.tobytes())

# Read points back
data = db.read("points", 0, 3, 1)
points_back = np.frombuffer(data, dtype=[('x', 'f8'), ('y', 'f8')])

print(points_back)</code></pre>

            <h3>Time Series Example</h3>
            <pre><code>import numstore
import time
import numpy as np

# Create database
db = numstore.Database("timeseries")

# Define a time series entry
db.create("sensor_data", "struct { timestamp i64, value f64 }")

# Simulate sensor readings
for i in range(1000):
    timestamp = int(time.time() * 1000)
    value = np.random.randn()

    entry = np.array([(timestamp, value)],
                     dtype=[('timestamp', 'i8'), ('value', 'f8')])

    db.append("sensor_data", entry.tobytes())
    time.sleep(0.01)

# Read last 100 entries
data = db.read("sensor_data", -100, -1, 1)
entries = np.frombuffer(data, dtype=[('timestamp', 'i8'), ('value', 'f8')])

print(f"Latest reading: {entries[-1]}")</code></pre>
        </section>

        <section class="section">
            <h2>Advanced Examples</h2>

            <h3>Transaction Example</h3>
            <pre><code># Start transaction
./nstore "begin transaction"

# Multiple operations in transaction
./nstore "create account1 f64"
./nstore "create account2 f64"
echo -e "\\x00\\x00\\x00\\x00\\x00\\x00\\x59\\x40" | ./nstore "insert account1 0"  # 100.0
echo -e "\\x00\\x00\\x00\\x00\\x00\\x00\\x49\\x40" | ./nstore "insert account2 0"  # 50.0

# Commit transaction
./nstore "commit transaction"

# If something goes wrong, use:
# ./nstore "rollback transaction"</code></pre>

            <h3>Large Data Transfer with TCP</h3>
            <pre><code># Start server
./nstore_server --port 5000

# In another terminal, use TCP protocol
./nstore_client "create big_array f64"

# Insert 1 million elements via TCP
./nstore_client "insert big_array:5001 0 1000000"

# Connect to port 5001 and stream data
nc localhost 5001 < large_file.bin</code></pre>

            <h3>Windowed Access for Large Datasets</h3>
            <pre><code># Create a very large variable with windowed access
./nstore "create huge_data f64 --windowed --window-size=10000"

# Insert data - only 10000 elements kept in memory at a time
cat very_large_file.bin | ./nstore "insert huge_data 0"

# Read data in chunks
for i in $(seq 0 10000 1000000); do
    ./nstore "read huge_data $i:$((i+10000)):1" > chunk_$i.bin
done</code></pre>
        </section>

        <section class="section">
            <h2>Performance Examples</h2>

            <h3>Benchmark: Sustained Writes</h3>
            <pre><code># Create a test variable
./nstore "create benchmark f64"

# Generate 10 GB of data and measure write speed
dd if=/dev/zero bs=1M count=10240 | \
  pv -pterb | \
  ./nstore "append benchmark"

# Expected: 640+ MB/s</code></pre>

            <h3>Benchmark: Random Access</h3>
            <pre><code># Create and populate a large variable
./nstore "create random_data i32"
cat 100m_integers.bin | ./nstore "insert random_data 0"

# Time random reads
time for i in $(seq 1 1000); do
    offset=$((RANDOM % 100000000))
    ./nstore "read random_data $offset:$((offset+1)):1" > /dev/null
done</code></pre>
        </section>

        <section class="section">
            <h2>More Examples</h2>
            <p>
                For more examples, check the <code>apps/examples/</code> directory in the
                repository. Examples cover:
            </p>
            <ul>
                <li>Basic CRUD operations</li>
                <li>Transaction handling</li>
                <li>Crash recovery</li>
                <li>Concurrent access</li>
                <li>Complex type operations</li>
                <li>Performance optimization</li>
                <li>Python and Java bindings</li>
                <li>Custom access patterns</li>
            </ul>
        </section>
    </main>

    <footer>
        <p>Copyright 2025 Theo Lincke | Licensed under the Apache License 2.0</p>
        <p><a href="https://gitlab.com/lincketheo/numstore">GitHub Repository</a></p>
    </footer>
</body>
</html>
